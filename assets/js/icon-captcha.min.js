/**
 * IconCaptcha Plugin: v3.0.0
 * Copyright Â© 2021, Fabian Wennink (https://www.fabianwennink.nl)
 *
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}var IconCaptchaPolyfills=function(){'use strict';return{extend:function(a){a=a||{};for(var b,c=1;c<arguments.length;c++)if(b=arguments[c],b)for(var d in b)b.hasOwnProperty(d)&&(a[d]="object"===_typeof(b[d])?b[d]instanceof Array?b[d].slice(0):IconCaptchaPolyfills.extend(a[d],b[d]):b[d]);return a},ajax:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a=a||{};var b=new XMLHttpRequest;if(b.open(a.type||"get",a.url,a.async||!0),a.success&&(b.onload=function(){if(200===b.status)try{a.success(JSON.parse(b.responseText))}catch(c){a.success(b.responseText)}else a.error&&a.error({message:"HTTP request returned with HTTP status code ".concat(b.status,".")})}),a.error&&(b.onerror=function(b){return a.error(b)}),a.headers)for(var c in a.headers)b.setRequestHeader(c,a.headers[c]);if(a.crossDomain||b.setRequestHeader("X-Requested-With","XMLHttpRequest"),!a.data)b.send();else if(a.processData=a.processData||!0,a.data instanceof FormData||a.processData){if(a.data=a.data||{},a.processData&&"object"===_typeof(a.data)){var d=new FormData;for(var e in a.data)d.append(e,a.data[e]);a.data=d}b.send(a.data)}else b.setRequestHeader("Content-Type","application/json"),b.send(JSON.stringify(a.data))},trigger:function(a,b,c){var d=null;window.CustomEvent&&"function"==typeof window.CustomEvent?d=new CustomEvent(b,{detail:c}):(d=document.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c)),a.dispatchEvent(d)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},offset:function(a){if(!a.getClientRects().length)return{top:0,left:0};var b=a.getBoundingClientRect(),c=a.ownerDocument.defaultView;return{top:b.top+c.pageYOffset,left:b.left+c.pageXOffset}},width:function(a){return parseFloat(getComputedStyle(a,null).width.replace("px",""))}}}();var IconCaptcha=function(){'use strict';var a={},b={general:{validationPath:null,fontFamily:null,credits:"show"},security:{clickDelay:1500,hoverDetection:!0,enableInitialMessage:!0,initializeDelay:500,selectionResetDelay:3e3,loadingAnimationDelay:1e3,invalidateTime:120000},messages:{initialization:{loading:"Loading challenge...",verify:"Verify that you are human."},header:"Select the image displayed the <u>least</u> amount of times",correct:"Verification complete.",incorrect:{title:"Uh oh.",subtitle:"You've selected the wrong image."},timeout:{title:"Please wait 60 sec.",subtitle:"You made too many incorrect selections."}}},c="https://www.fabianwennink.nl/projects/IconCaptcha",d="IconCaptcha by Fabian Wennink";a.init=function(a,c){if(!f(this.nodes)){this.nodes=document.querySelectorAll(a);var d=IconCaptchaPolyfills.extend({},b,c||{});return e(this.nodes,function(a,b){g(a,b,d)}),this}},a.$init=function(a,c){if(!f(this.nodes)){this.nodes=a;var d=IconCaptchaPolyfills.extend({},b,c||{});return e(this.nodes,function(a,b){g(a,b,d)}),this}},a.bind=function(a,b){return e(this.nodes,function(c){c.addEventListener(a,b)}),this};var e=function(a,b){for(var c=0;c<a.length;c++)b(a[c],c)},f=function(a){return!!a&&(console.error("IconCaptcha has already been initialized."),!0)},g=function(a,b,f){var g=Math.round;function h(){var a;D=null===(a=document.querySelector("input[name=\"_iconcaptcha-token\"]"))||void 0===a?void 0:a.value;var b=F.getAttribute("data-theme")||"light";return F.classList.add("iconcaptcha-theme-"+b),f.general.fontFamily&&(F.style.fontFamily=f.general.fontFamily),!G&&f.security.enableInitialMessage?(x(),void j()):void(!J&&k(),p(),f.security.loadingAnimationDelay&&0<f.security.loadingAnimationDelay&&!f.security.enableInitialMessage?setTimeout(function(){return i(b)},f.security.loadingAnimationDelay):i(b))}function i(a){var b=w({i:E,a:1,t:a,tk:D});IconCaptchaPolyfills.ajax({url:f.general.validationPath,type:"post",headers:{"X-IconCaptcha-Token":D},data:{payload:b},success:function(a){if(a&&"string"==typeof a){var b=JSON.parse(atob(a));if(b.error)return void u(b.error,b.data);var c=w({i:E,tk:D}),d=B.querySelector(".iconcaptcha-modal__body-icons");d.style.backgroundImage="url(".concat(f.general.validationPath,"?payload=").concat(c,")"),r(d),d.parentNode.insertAdjacentHTML("beforeend","<div class=\"iconcaptcha-modal__body-selection\"><i></i></div>"),C=B.querySelector(".iconcaptcha-modal__body-selection > i");var e=F.querySelector(".iconcaptcha-modal__body-selection");y(e),J||IconCaptchaPolyfills.trigger(F,"init",{captchaId:E});var g=B.querySelector(".iconcaptcha-modal__body-selection");return I=IconCaptchaPolyfills.width(g),K=new Date,J=!0,void(H=setTimeout(function(){return s(!0)},f.security.invalidateTime))}v(!0,"The IconCaptcha could not be loaded.","Invalid data was returned by the captcha back-end service. Make sure IconCaptcha is installed/configured properly.")},error:function(){return o()}})}function j(){var a=["<div class='iconcaptcha-modal'>","<div class='iconcaptcha-modal__body'>","<div class='iconcaptcha-modal__body-circle'></div>","<div class='iconcaptcha-modal__body-info'>","<a href='".concat(c,"' target='_blank' rel='follow' title='").concat(d,"'>IconCaptcha &copy;</a>"),"</div>","<div class='iconcaptcha-modal__body-title'>".concat(f.messages.initialization.verify,"</div>"),"</div>","</div>"];F.classList.add("iconcaptcha-init"),F.classList.remove("iconcaptcha-error","iconcaptcha-success"),F.innerHTML=a.join("")}function k(){var a=["<div class='iconcaptcha-modal'>","<div class='iconcaptcha-modal__header'>","<span>".concat(f.messages.header,"</span>"),"</div>","<div class='iconcaptcha-modal__body'>","<div class='iconcaptcha-modal__body-icons'></div>","</div>","<div class='iconcaptcha-modal__footer'>"];if("show"===f.general.credits||"hide"===f.general.credits){var b="hide"===f.general.credits?"display: none":"";a.push("<span style='".concat(b,"'><a href='").concat(c,"' target='_blank' rel='follow' title='").concat(d,"'>IconCaptcha</a> &copy;</span>"))}a.push("</div>","<div class='iconcaptcha-modal__fields'>","<input type='hidden' name='ic-hf-se' required />","<input type='hidden' name='ic-hf-id' value='".concat(E,"' required />"),"<input type='hidden' name='ic-hf-hp' required />","</div>"),a.push("</div>"),F.innerHTML=a.join(""),B=F.querySelector(".iconcaptcha-modal__body")}function l(){F.classList.remove("iconcaptcha-error"),F.querySelector("input[name='ic-hf-se']").setAttribute("value",null),IconCaptchaPolyfills.empty(B),B.insertAdjacentHTML("beforeend","<div class='iconcaptcha-modal__body-icons'></div>"),h(),IconCaptchaPolyfills.trigger(F,"refreshed",{captchaId:E})}function m(a,b){if(a!==void 0&&b!==void 0){L=!0,t(),a=g(a),b=g(b),F.querySelector("input[name=\"ic-hf-se\"]").setAttribute("value",[a,b,I].join(",")),F.querySelector("input[name=\"ic-hf-id\"]").setAttribute("value",E),C.style.display="none";var c=w({i:E,x:a,y:b,w:I,a:2,tk:D});IconCaptchaPolyfills.ajax({url:f.general.validationPath,type:"POST",headers:{"X-IconCaptcha-Token":D},data:{payload:c},success:function(){return n()},error:function(){return o()}})}}function n(){B.classList.remove("captcha-opacity");var a=F.querySelector(".iconcaptcha-modal__body-selection");z(a);var b=F.querySelectorAll(".iconcaptcha-modal__header, .iconcaptcha-modal__footer, .iconcaptcha-modal__body");e(b,function(a){a.parentNode.removeChild(a)}),F.classList.add("iconcaptcha-success");var g=F.querySelector(".iconcaptcha-modal");g.innerHTML+="<div class=\"iconcaptcha-modal__body\">"+"<div class=\"iconcaptcha-modal__body-title\">".concat(f.messages.correct,"</div>")+"<div class=\"iconcaptcha-modal__body-checkmark\">".concat("<svg viewBox=\"0 0 98.5 98.5\" xml:space=\"preserve\" xmlns=\"http://www.w3.org/2000/svg\"><path class=\"checkmark\" d=\"M81.7 17.8C73.5 9.3 62 4 49.2 4 24.3 4 4 24.3 4 49.2s20.3 45.2 45.2 45.2 45.2-20.3 45.2-45.2c0-8.6-2.4-16.6-6.5-23.4L45.6 68.2 24.7 47.3\" fill=\"none\" stroke-miterlimit=\"10\" stroke-width=\"8\"/></svg>","</div>")+"<div class='iconcaptcha-modal__body-info'>"+"<a href='".concat(c,"' target='_blank' rel='follow' title='").concat(d,"'>IconCaptcha &copy;</a>")+"</div></div>",L=!1,IconCaptchaPolyfills.trigger(F,"success",{captchaId:E})}function o(a,b){var c=!(2<arguments.length&&arguments[2]!==void 0)||arguments[2];B.classList.remove("captcha-opacity");var d=F.querySelector(".iconcaptcha-modal__body-selection");z(d),a=a||f.messages.incorrect.title,b=b||f.messages.incorrect.subtitle,F.classList.add("iconcaptcha-error"),B.innerHTML="<div class=\"iconcaptcha-modal__body-title\">".concat(a,"</div>")+"<div class=\"iconcaptcha-modal__body-subtitle\">".concat(b,"</div>"),L=!1,IconCaptchaPolyfills.trigger(F,"error",{captchaId:E}),c&&setTimeout(l,f.security.selectionResetDelay)}function p(){B.classList.add("captcha-opacity"),B.insertAdjacentHTML("beforeend","<div class=\"captcha-loader\"></div>")}function q(){var a;B.classList.remove("captcha-opacity");var b=B.querySelector(".captcha-loader");null===b||void 0===b||null===(a=b.parentNode)||void 0===a?void 0:a.removeChild(b)}function r(a){var b=a.style.backgroundImage.match(/\((.*?)\)/)[1].replace(/(['"])/g,""),c=new Image;c.onload=function(){return q()},c.src=b,c.complete&&c.onload(this)}function s(){var a=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(J=!1,G=!1,a){var b=w({i:E,a:3,tk:D});IconCaptchaPolyfills.ajax({url:f.general.validationPath,type:"post",headers:{"X-ICONCAPTCHA-TOKEN":D},data:{payload:b},success:function(){IconCaptchaPolyfills.trigger(F,"invalidated",{captchaId:E}),j()},error:function(){return o()}})}else j()}function t(){null!==H&&(clearTimeout(H),H=null)}function u(a,b){if(a=parseInt(a),1===a){o(f.messages.timeout.title,f.messages.timeout.subtitle,!1);var c=F.querySelector(".iconcaptcha-modal__header");c.parentNode.removeChild(c),IconCaptchaPolyfills.trigger(F,"timeout",{captchaId:E}),setTimeout(function(){return s(!1)},b)}}function v(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"";F.innerHTML="IconCaptcha Error: "+b,console.error("IconCaptcha Error: "+(""!==c)?c:b),a&&IconCaptchaPolyfills.trigger(F,"error",{captchaId:E})}function w(a){return btoa(JSON.stringify(a))}function x(){f.security.enableInitialMessage&&F.addEventListener("click",function(a){G||a.target instanceof HTMLAnchorElement||(G=!0,F.querySelector(".iconcaptcha-modal__body-circle").style.animationDuration="2s",F.querySelector(".iconcaptcha-modal__body-title").innerText=f.messages.initialization.loading,setTimeout(function(){F.classList.remove("iconcaptcha-init"),h()},f.security.initializeDelay))})}function y(a){var b=function(a){if(!(new Date-K<=f.security.clickDelay)&&(!f.security.hoverDetection||M)){var b=IconCaptchaPolyfills.offset(a.currentTarget),c=a.pageX-b.left,d=a.pageY-b.top;c&&d&&!B.classList.contains("captcha-opacity")&&(IconCaptchaPolyfills.trigger(F,"selected",{captchaId:E}),f.security.loadingAnimationDelay&&0<f.security.loadingAnimationDelay?(p(),setTimeout(function(){return m(c,d)},f.security.loadingAnimationDelay)):m(c,d))}},c=function(a){M&&!L&&J&&A(a)},d=function(a){C.style.display="inline",A(a),M=!0},e=function(){C.style.display="none",M=!1};for(var g in a._ic_listeners={click:b,mousemove:c,mouseenter:d,mouseleave:e},a._ic_listeners)a.addEventListener(g,a._ic_listeners[g])}function z(a){if(a&&a._ic_listeners)for(var b in a._ic_listeners)a.removeEventListener(b,a._ic_listeners[b])}function A(a){if(null!=a.currentTarget){var b=IconCaptchaPolyfills.offset(a.currentTarget);C.style.left=g(a.pageX-b.left)-8+"px",C.style.top=g(a.pageY-b.top)-7+"px"}}var B,C,D,E=b+1,F=a,G=!1,H=null,I=0,J=!1,K=0,L=!1,M=!1;return f.general.validationPath?void h():void v(!0,"The IconCaptcha was configured incorrectly.","The option `validationPath` has not been set.")};return a}();null!=window.jQuery&&function(a){a.fn.extend({iconCaptcha:function(a){for(var b=[],c=0;c<this.length;c++)b.push(this[c]);return IconCaptcha.$init(b,a)}})}(jQuery);